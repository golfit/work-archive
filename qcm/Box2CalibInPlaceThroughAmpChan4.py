from numpy import *
#17 June 2012 - Vdiv calibration for Box 2 in ANT position through Channel 4 of 1-to-1 amplifier.
#Calibration data - transfer function 
fspS=[ 39848.197, 44064.938, 48492.515, 52920.093, 57347.670, 61775.248, 66202.825, 70560.124, 74917.422, 79204.442, 83632.019, 88059.597, 92416.895, 96774.194,101131.492,105418.511,109705.531,114062.829,118420.128,122636.868,126853.609,131210.907,135497.927,139714.667,143861.129,148218.427,152505.447,156792.466,160938.928,165155.668,169161.571,173448.591,177665.331,181811.793,186098.812,190315.553,194462.014,198608.476,202684.658,206971.678,210907.302,215194.321,219200.225,223416.965,227493.148,231639.609,235645.513,239862.253,243797.878,247944.339,252020.521,256096.704,260102.607,264178.790,268184.693,272260.876,276266.779,280342.962,284278.586,288284.489,292360.672,296296.296,300372.479,304237.824]

HspSr=[181.96716,187.09111,190.07754,191.72463,192.73684,193.55293,194.75368,195.57572,196.12336,196.56939,196.97568,197.33419,197.66942,198.00027,198.29923,198.54962,198.73337,198.86729,198.93794,198.93568,198.85248,198.72927,198.56321,198.33226,198.05814,197.75322,197.41905,197.04682,196.67833,196.30742,195.93046,195.53611,195.14181,194.74653,194.32758,193.91409,193.47302,193.01314,192.53055,192.00829,191.45963,190.91216,190.36005,189.77179,189.17382,188.59613,187.99247,187.38257,186.77164,186.18692,185.61860,185.06580,184.50016,183.96136,183.44505,182.91429,182.42804,181.97224,181.52648,181.07526,180.60389,180.18386,179.82160,179.51456]

HspSi=[-1.97278,0.23772,1.68738,3.04909,4.27343,5.43999,6.64941,7.82871,8.96089,10.04194,11.08893,12.10613,13.10242,14.07782,15.03848,16.00005,16.92058,17.81930,18.68747,19.57245,20.42607,21.25747,22.09065,22.91446,23.71877,24.50668,25.29392,26.07505,26.85479,27.61287,28.39466,29.18101,29.96224,30.73252,31.52770,32.31011,33.08806,33.87220,34.63695,35.40658,36.15429,36.90549,37.66167,38.42406,39.16155,39.91383,40.65112,41.38086,42.13712,42.88962,43.64933,44.40449,45.15367,45.91104,46.66308,47.41366,48.17699,48.95360,49.73161,50.49621,51.25274,52.02384,52.83710,53.59471]

fsdS=[ 37929.203, 41482.532, 43031.679, 44386.670, 45929.504, 47158.070, 48726.286, 49703.435, 50853.838, 51633.265, 52853.784, 53575.075, 54852.196, 55714.108, 56755.277, 57571.890, 58533.326, 59590.758, 60590.633, 61646.993, 62363.697, 63389.178, 63964.974, 64712.597, 65811.933, 66915.888, 68517.662, 69196.625, 70156.362, 70806.415, 71282.027, 72425.990, 73127.070, 73708.869, 74797.939, 75495.645, 76146.459, 77044.599, 77932.769, 78543.166, 79401.914, 80298.106, 81225.292, 82101.460, 82630.151, 83467.981, 84454.475, 84901.977, 85693.527, 86750.259, 87309.172, 88325.024, 89084.180, 89571.320, 90213.074, 91117.377, 91787.184, 92525.529, 93473.853, 94055.084, 94659.710, 95772.533, 96377.558, 97325.053, 98413.548, 99037.082,100036.260,100727.133,101309.848,102400.163,103175.870,103731.793,104539.856,105379.767,106068.040,107047.958,107670.744,108193.108,108977.059,109873.365,110424.889,110938.845,112117.582,112704.881,113431.121,114419.656,114992.735,115568.017,116541.255,117206.191,117761.697,118604.733,119410.363,119928.399,120474.001,121481.275,122100.983,122609.106,123256.619,124159.265,124724.803,125226.267,126054.128,126912.809,127384.626,128190.292,129121.109,129606.983,130342.707,131254.571,131720.782,132269.336,133080.989,133880.804,134373.656,134897.007,135882.201,136614.708,137117.463,137739.597,138658.531,139225.946,139766.222,140553.343,141401.325,141882.690,142426.820,143272.961,144051.475,144600.777,145126.094,146092.374,146704.574,147210.433,148145.452,148859.321,149339.756,150184.801,150964.868,151486.313,151877.774,152595.249,153585.817,154123.075,154636.154,155601.473,156251.001,156783.710,157534.911,158430.181,158914.259,159460.966,160284.716,161060.726,161590.435,161990.382,162684.099,163689.076,164270.165,164631.624,165494.341,166420.665,166922.610,167566.940,168308.032,169177.942,169679.404,170203.083,171046.148,171830.442,172307.933,172850.340,173750.035,174457.848,174953.026,175522.487,176443.275,177083.278,177589.614,178216.610,179132.828,179694.427,180217.930,180932.644,181808.891,182353.663,182891.008,183755.917,184510.967,185000.065,185543.901,186458.411,187143.903,187641.919,188226.225,189152.207,189754.583,190268.248,190932.724,191837.108,192361.118,192898.229,193646.105,194504.940,194982.825,195519.561,196392.080,197140.958,197637.383,198080.823,198663.699,199835.824,201024.613,201692.688,202587.140,203113.495,203653.177,204407.999,205254.168,205732.086,206273.482,207157.186,207897.523,208392.054,208825.488,209411.351,210211.681,211018.443,211502.888,212035.755,212936.964,213647.839,214140.809,214703.736,215643.428,216265.118,216780.815,217395.366,218098.477,218716.699,219411.534,219908.239,220669.910,221590.606,222262.126,223114.090,224025.439,224572.373,225101.852,225846.477,226686.226,227199.522,227708.203,228238.673,228902.808,229821.635,230308.484,230856.021,231657.580,232450.942,233081.607,233474.812,234314.476,235295.389,235772.054,236205.106,236817.547,237702.445,238377.569,238878.182,239598.379,240478.403,241041.523,241560.293,242055.566,242665.455,243591.454,244153.294,244675.701,245411.697,246256.061,246775.010,247290.188,247816.824,248459.943,249424.157,250254.593,250998.461,251887.393,252432.623,252953.729,253462.670,254078.993,255009.207,255549.149,256078.809,256833.346,257662.818,258172.129,258683.648,259220.934,259880.335,260796.342,261289.757,261825.034,262657.517,263431.678,263924.302,264396.745,264972.325,265711.222,266552.368,267051.838,267544.504,268104.646,268772.434,269678.074,270170.792,270700.706,271554.270,272319.278,272798.500,273276.245,273841.129,274606.073,275446.041,275901.279,276501.975,277173.522,277812.678,278513.417,279062.900,279564.657,280448.615,281204.887,281675.719,282147.618,282713.402,283511.256,284321.810,284858.853,285814.968,286596.093,287262.323,287815.988,288390.721,289010.832,289723.677,290346.310,290974.016,291478.362,292215.227,293069.210,293562.877,294079.349,294615.603,295294.208,296178.934,296703.076,297218.345,297745.550,298368.211,299305.109,299813.734,300364.235,301122.901,301945.572,302466.576,302920.985,303528.086,304128.605]

HsdSr=[182.35423,184.33097,185.46515,186.80605,188.00823,188.88630,189.88484,190.76252,191.56169,192.20650,192.80051,193.19740,193.52573,193.78592,194.13656,194.34552,194.50179,194.68105,194.82840,194.93894,195.03329,195.14674,195.24932,195.37304,195.42883,195.48163,195.49836,195.52751,195.60773,195.72532,195.74293,195.76469,195.78540,195.86843,195.89994,195.92575,196.00583,196.05594,196.07062,196.15223,196.23483,196.28791,196.34451,196.33756,196.42351,196.53025,196.61411,196.70189,196.78876,196.88060,196.99873,197.08163,197.16578,197.26643,197.32215,197.37452,197.43359,197.50055,197.56327,197.61801,197.65514,197.69260,197.73797,197.85159,197.96815,198.02676,198.08589,198.17945,198.25097,198.32285,198.43142,198.49662,198.56396,198.59086,198.64361,198.71227,198.73901,198.71859,198.78025,198.75593,198.72307,198.73990,198.75114,198.74714,198.73715,198.77109,198.81913,198.85443,198.84264,198.85886,198.90253,198.94044,198.95323,198.96552,198.95052,198.89659,198.83932,198.83870,198.79898,198.80832,198.76871,198.75234,198.74697,198.73618,198.68598,198.65729,198.66243,198.65711,198.67603,198.66794,198.65142,198.63270,198.56222,198.54426,198.54272,198.56819,198.53790,198.46315,198.38354,198.35752,198.29554,198.23938,198.26057,198.21153,198.15516,198.08655,198.02713,198.00822,197.98729,197.90838,197.85798,197.78888,197.69046,197.61162,197.58220,197.57142,197.51782,197.44976,197.37677,197.35566,197.32291,197.28804,197.23663,197.20430,197.14484,197.05223,197.01555,196.95671,196.91846,196.81950,196.75255,196.68493,196.63460,196.56538,196.48549,196.42079,196.35045,196.27020,196.17106,196.11634,196.04123,195.97188,195.93111,195.86387,195.79542,195.71248,195.60809,195.54940,195.48630,195.40742,195.34992,195.28026,195.21282,195.17604,195.13258,195.11117,195.09183,195.01990,194.95794,194.91699,194.86976,194.82903,194.76441,194.68709,194.63238,194.57386,194.52986,194.51317,194.47616,194.42495,194.35298,194.29823,194.23735,194.15870,194.08278,193.99101,193.90781,193.81582,193.71776,193.63399,193.58935,193.48554,193.40953,193.35046,193.29494,193.26907,193.21359,193.16483,193.09682,193.00632,192.90380,192.82685,192.71944,192.62445,192.51057,192.37878,192.26987,192.13827,192.08547,192.01426,191.94052,191.86582,191.79706,191.72654,191.64424,191.54981,191.44089,191.34862,191.25172,191.16402,191.06931,190.98106,190.90524,190.83780,190.74269,190.65661,190.56180,190.48702,190.35937,190.33449,190.30085,190.18358,190.07904,189.94459,189.85867,189.74717,189.65190,189.53243,189.42760,189.20090,189.04642,188.95937,188.86336,188.77157,188.63505,188.54546,188.46356,188.37890,188.32220,188.25141,188.14044,188.06522,187.96513,187.90902,187.87718,187.81232,187.74523,187.66237,187.56446,187.48204,187.40429,187.27479,187.16424,187.00469,186.84484,186.71644,186.58316,186.46948,186.33763,186.20846,186.08499,186.15238,186.06427,185.96972,185.86416,185.74575,185.64033,185.53391,185.42443,185.34849,185.25766,184.98994,184.89506,184.80590,184.72481,184.64816,184.57232,184.49625,184.41957,184.32100,184.24461,184.15680,184.07637,183.98905,183.90419,183.80980,183.71844,183.65056,183.58253,183.50096,183.42120,183.33627,183.24604,183.18745,183.11274,183.05050,182.99115,182.90275,182.85052,182.80763,182.72319,182.67988,182.63043,182.56730,182.50510,182.42163,182.34188,182.25940,182.17110,182.07810,182.01338,181.92272,181.83552,181.74397,181.67897,181.61264,181.53679,181.46507,181.37222,181.29778,181.20892,181.13740,181.07516,181.01644,180.92259,180.83439,180.76784,180.68449,180.63040,180.54912,180.45592,180.35470,180.26915,180.19210,180.13753,180.10746,180.06881,180.00612,179.93581,179.88581,179.86500,179.82890,179.75490,179.68938,179.63744,179.55656,179.49187,179.43865,179.36651,179.39891,179.64905]

HsdSi=[-1.96996,-0.43618,-0.04816,0.40675,0.84124,1.28571,1.66134,1.94957,2.30692,2.64534,2.90340,3.32700,3.60093,3.90165,4.26824,4.57625,4.88966,5.17907,5.48427,5.76848,6.06237,6.22794,6.55478,6.81730,6.97978,7.15933,7.40324,7.57468,7.81713,8.00644,8.22846,8.45125,8.56910,8.72076,8.92366,9.09471,9.31725,9.52931,9.68373,9.84751,10.03671,10.21619,10.41689,10.62517,10.78007,11.01632,11.22868,11.42768,11.64142,11.85716,11.99117,12.17809,12.34796,12.51380,12.66715,12.82084,12.94652,13.13309,13.32883,13.51455,13.73590,13.91027,14.09153,14.29023,14.50411,14.67970,14.88657,15.05657,15.22821,15.39518,15.57158,15.72461,15.88836,16.03749,16.21987,16.38921,16.56776,16.67515,16.75978,16.88939,17.03947,17.22585,17.39364,17.50667,17.62870,17.73312,17.86560,18.02341,18.19939,18.35203,18.48957,18.60330,18.75931,18.93438,19.08992,19.25055,19.37967,19.58553,19.73658,19.86515,19.98753,20.12772,20.28615,20.41140,20.52832,20.69671,20.85255,20.97950,21.09964,21.24832,21.39715,21.48995,21.59354,21.68705,21.82680,21.94809,22.09003,22.18899,22.34543,22.49632,22.63318,22.82598,22.98401,23.16038,23.24831,23.37572,23.48819,23.62931,23.71874,23.84893,23.95076,24.06494,24.19083,24.32191,24.48930,24.61723,24.72323,24.83637,24.96115,25.10046,25.23004,25.34771,25.46493,25.57226,25.67463,25.77162,25.90320,26.04352,26.13674,26.24846,26.38596,26.49531,26.62562,26.77052,26.87263,27.01086,27.13170,27.24209,27.41520,27.51597,27.64539,27.75340,27.86598,27.99136,28.16526,28.29782,28.45188,28.57223,28.66913,28.77342,28.86481,29.01198,29.13703,29.24619,29.36889,29.48951,29.57961,29.69581,29.84545,29.96674,30.10232,30.21442,30.30243,30.41016,30.52479,30.66537,30.80644,30.94751,31.06361,31.21977,31.35286,31.47859,31.64483,31.82938,31.97474,32.07975,32.18561,32.32409,32.47307,32.61956,32.73250,32.88875,32.99481,33.09792,33.18395,33.30732,33.41889,33.54149,33.68332,33.80629,33.98068,34.13087,34.27836,34.39713,34.54222,34.70402,34.86016,34.97681,35.07404,35.19577,35.28845,35.37830,35.50075,35.63570,35.75280,35.87768,35.99406,36.12995,36.25003,36.34285,36.45330,36.56570,36.70382,36.81677,36.95816,37.04605,37.18308,37.30033,37.44088,37.54355,37.69199,37.82189,37.91336,38.05885,38.19378,38.32303,38.42961,38.53761,38.64431,38.80271,38.90540,39.01926,39.13294,39.20975,39.31070,39.42808,39.56837,39.69850,39.82791,39.95740,40.10283,40.24889,40.37624,40.49377,40.62363,40.77283,40.89712,41.03206,41.14431,41.27154,41.36180,41.47274,41.57697,41.70959,41.79908,41.89552,42.01366,42.10844,42.22848,42.32589,42.46374,42.62740,42.77265,42.89345,43.03018,43.15774,43.27069,43.37920,43.49881,43.62576,43.74529,43.81074,43.91531,44.03180,44.14172,44.24406,44.35643,44.49610,44.61614,44.73094,44.84513,44.97424,45.11276,45.24208,45.38714,45.51034,45.65346,45.78910,45.93073,46.04474,46.15818,46.29672,46.40733,46.53287,46.65074,46.77912,46.89739,47.00544,47.12978,47.27373,47.42734,47.53514,47.67120,47.79496,47.90647,48.04162,48.15981,48.24723,48.33420,48.45050,48.56621,48.70916,48.82164,48.94235,49.06642,49.17760,49.30457,49.49526,49.65574,49.77341,49.87009,49.98595,50.12892,50.24946,50.36631,50.48623,50.60682,50.68428,50.79394,50.93023,51.05911,51.16581,51.29554,51.43448,51.56000,51.68704,51.81321,51.95188,52.08176,52.19888,52.34287,52.47983,52.61136,52.73508,52.87746,52.99814,53.13755,53.27352,53.40499,53.47453,53.64759]

#Combine real and imaginary parts of transfer function
HspS=double(HspSr)+1j*double(HspSi) #Synchronous detection
HsdS=double(HsdSr)+1j*double(HsdSi) #Spectrogram method
#Save data to numpy binary array
save("fsdSBox2", fsdS)
save("HsdSBox2", HsdS)
save("fspSBox2", fspS)
save("HspSBox2", HspS)
