#SaveBox1NewCalibVals.py
#This script stores text-versions of the new I/V Box #1 calibration.  A new calibration was needed because the two ~220 nF caps in the C_high leg of the capacitive voltage divider, as well as the single ~82 nF cap in the C_low leg (not the remaining two trim capacitors in C_low), were changed.  The change was in response to odd voltage measurements wherein the voltage level coming out of the divider was too big, given the assumed operating parameters.  The actual problem seems to have been localized to the transformer or cabling around it, and was remedied by swapping the transformer.  Maybe a loose connection.  Probably not the components of the I/V box.  Regardless, the change was made and a new calibration was needed.
#
#In this calibration, the "sd" suffix refers to "synchronous detection", and the "sp" to spectrogram.  These specify how the transfer function from the 100:1 scope probe voltage (scaled) to the capacitive voltage divider voltage was obtained.  The spectrogram method may be a little more reliable below about 60 kHz, especially in amplitude; otherwise, the methods are comparable.  The calibration, itself, was run using Paul Woskov's amplifier with over 700 W output, into a 1 kW dummy load (which was smoked during the test).  The data was then smoothed.
#Ted Golfinopoulos, 3 May 2012

from numpy import *
from scipy import *

#Spectrogram method
fspS=[41121.443775, 43933.166427, 47447.819741, 50962.473055, 54477.126369, 57991.779683, 61506.432997, 65021.086311, 68535.739626, 72050.392940, 75565.046254, 79079.699568, 82594.352882, 86109.006196, 89623.659510, 93138.312824, 96652.966139, 100167.619453, 103682.272767, 107196.926081, 110711.579395, 114226.232709, 117740.886023, 121255.539337, 124770.192652, 128284.845966, 131799.499280, 135314.152594, 138828.805908, 142343.459222, 145858.112536, 149372.765850, 152887.419165, 156402.072479, 159916.725793, 163431.379107, 166946.032421, 170460.685735, 173975.339049, 177489.992363, 181004.645678, 184519.298992, 188033.952306, 191548.605620, 195063.258934, 198577.912248, 202092.565562, 205607.218877, 209121.872191, 212636.525505, 216151.178819, 219665.832133, 223180.485447, 226695.138761, 230209.792075, 233724.445390, 237239.098704, 240753.752018, 244268.405332, 247783.058646, 251297.711960, 254812.365274, 258327.018588, 261841.671903, 265356.325217, 268870.978531, 272385.631845, 275900.285159, 279414.938473, 282929.591787, 286444.245101, 289958.898416, 293473.551730, 296988.205044, 300502.858358, 303666.046341]

HspSr=[188.66704, 190.10884, 192.04298, 193.46340, 194.59507, 195.54427, 196.66699, 197.55730, 198.30187, 198.93780, 199.49616, 199.98343, 200.41371, 200.79207, 201.13345, 201.44343, 201.72256, 201.97022, 202.19656, 202.40365, 202.59607, 202.77291, 202.93968, 203.09123, 203.23676, 203.36783, 203.49549, 203.61219, 203.72860, 203.83653, 203.93373, 204.02563, 204.10727, 204.19209, 204.26791, 204.33766, 204.40803, 204.48310, 204.54858, 204.60912, 204.67160, 204.72514, 204.77673, 204.82188, 204.87547, 204.92353, 204.96931, 205.00636, 205.04569, 205.08611, 205.12305, 205.16113, 205.20179, 205.24431, 205.27651, 205.31282, 205.34256, 205.37588, 205.40249, 205.42689, 205.44913, 205.48252, 205.50784, 205.53487, 205.56440, 205.59424, 205.62359, 205.65592, 205.68725, 205.71449, 205.74117, 205.76863, 205.78698, 205.80645, 205.81000, 205.94176]

HspSi=[-8.55323, -7.93123, -6.96435, -6.21720, -5.63235, -5.17124, -4.60510, -4.15618, -3.78656, -3.47737, -3.22514, -3.01438, -2.83690, -2.68749, -2.55343, -2.43046, -2.33845, -2.26460, -2.19753, -2.14869, -2.10386, -2.06784, -2.03530, -2.01042, -1.99753, -1.99568, -1.99516, -1.99056, -1.99012, -1.99515, -2.00031, -2.00709, -2.03275, -2.06082, -2.08185, -2.10485, -2.13287, -2.16487, -2.20046, -2.23320, -2.27294, -2.31331, -2.35055, -2.37355, -2.40846, -2.44041, -2.47266, -2.51137, -2.54389, -2.58309, -2.61849, -2.65740, -2.68912, -2.71873, -2.74847, -2.78060, -2.80939, -2.83380, -2.86786, -2.89649, -2.92322, -2.93670, -2.95850, -2.99503, -3.03660, -3.06910, -3.10696, -3.14895, -3.18265, -3.22285, -3.26518, -3.32443, -3.36088, -3.41194, -3.46435, -3.61674]

#Complex transfer function - multiply the Fourier transform of the output voltage of the capacitive voltage divider by this and then inverse Fourier transform to construct the correct output voltage.
HspS=double(HspSr)+1j*double(HspSi)

#Synchronous detection calibration function.
fsdS=[37424.599648, 41653.559583, 44227.526315, 46131.055677, 49182.168289, 50653.295074, 53606.174870, 55780.139083, 57089.113372, 59985.645754, 62107.861063, 63587.551379, 66341.808856, 68092.551181, 72247.547634, 76712.785141, 80658.842945, 85017.112949, 89356.396895, 93594.048933, 97618.982326, 101981.470895, 106214.511458, 110216.458537, 114905.692521, 118811.457962, 123044.255290, 127534.078024, 131430.020086, 135934.599773, 140156.073768, 144331.189337, 148525.046917, 152760.930482, 156941.848825, 161419.713204, 165665.506650, 169585.675744, 174018.462113, 178282.876997, 182210.717286, 186363.464620, 189397.824146, 190610.062055, 192888.915788, 195703.734509, 196911.820645, 199199.992656, 202010.401360, 203216.132176, 205529.644680, 208522.597879, 210151.874011, 211854.322897, 214813.919149, 216735.761109, 218191.155174, 221125.972484, 223036.152514, 224513.549037, 227439.744189, 229328.675395, 230838.737393, 233757.888017, 235600.132458, 237403.766072, 240189.520604, 241874.393523, 243703.690258, 246510.919280, 248176.951532, 250004.142807, 252829.825201, 254483.568223, 256307.757635, 259129.624229, 261355.197451, 262616.043654, 265437.773273, 267656.050461, 268929.205712, 271759.176422, 273958.679234, 275239.076735, 278084.841339, 280215.590980, 281787.881547, 284438.498600, 286533.009668, 288269.308371, 290768.927002, 292476.002746, 294314.489648, 297087.817995, 299011.269492, 300795.143946]

HsdSr=[199.05837, 199.79194, 199.09048, 197.58215, 197.07984, 196.98346, 196.74508, 196.55577, 196.45237, 196.58390, 197.09146, 197.62422, 198.15029, 198.64785, 199.12736, 199.59044, 200.02534, 200.43851, 200.85210, 201.22315, 201.55419, 201.84666, 202.11577, 202.35132, 202.56785, 202.76578, 202.94892, 203.11071, 203.26541, 203.41517, 203.55713, 203.69295, 203.80766, 203.92983, 204.03262, 204.13144, 204.22284, 204.31694, 204.39592, 204.46153, 204.51805, 204.57406, 204.62548, 204.66010, 204.69856, 204.72940, 204.75556, 204.77954, 204.81091, 204.83858, 204.86068, 204.88717, 204.91028, 204.93041, 204.95372, 204.97891, 205.00893, 205.03144, 205.05018, 205.06241, 205.08955, 205.11090, 205.13244, 205.16095, 205.18529, 205.20489, 205.21826, 205.23180, 205.24835, 205.27129, 205.28638, 205.29426, 205.30863, 205.32259, 205.33166, 205.34771, 205.36792, 205.39145, 205.40305, 205.42731, 205.44927, 205.47474, 205.49399, 205.51264, 205.53373, 205.55352, 205.57558, 205.59069, 205.61153, 205.61142, 205.63191, 205.61762, 205.62793, 205.62708, 205.60543, 205.61053]

HsdSi=[-7.43645, -6.39943, -6.55689, -6.34487, -6.04337, -5.73344, -5.44799, -5.21252, -4.90764, -4.59269, -4.30699, -4.02726, -3.77049, -3.53250, -3.31251, -3.11950, -2.97711, -2.80988, -2.64540, -2.49958, -2.38517, -2.29105, -2.21999, -2.16245, -2.11519, -2.08275, -2.06176, -2.05005, -2.04254, -2.03133, -2.02611, -2.02941, -2.04326, -2.06599, -2.09051, -2.11340, -2.13731, -2.15911, -2.18845, -2.22549, -2.26033, -2.29902, -2.32294, -2.34754, -2.37538, -2.39570, -2.41618, -2.44008, -2.46319, -2.48732, -2.51009, -2.53353, -2.55497, -2.57187, -2.58517, -2.60898, -2.63523, -2.65256, -2.67976, -2.70542, -2.72567, -2.74906, -2.76994, -2.78470, -2.80841, -2.82567, -2.84175, -2.86575, -2.87676, -2.87851, -2.89777, -2.90922, -2.92317, -2.95224, -2.96450, -2.97822, -2.98625, -2.99039, -3.00933, -3.03810, -3.05554, -3.08144, -3.10787, -3.12112, -3.15091, -3.26453, -3.30104, -3.33641, -3.36786, -3.39934, -3.47601, -3.50349, -3.57367, -3.52047, -3.60066, -3.75463]

#Complex transfer function - multiply the Fourier transform of the output voltage of the capacitive voltage divider by this and then inverse Fourier transform to construct the correct output voltage.
HsdS=double(HsdSr) + 1j*double(HsdSi)

#Save data to numpy format.
save('fsdSBox1', fsdS)
save('HsdSBox1', HsdS)
save('fspSBox1', fspS)
save('HspSBox1', HspS)
