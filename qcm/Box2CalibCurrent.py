from numpy import *
#This was made on 18 June 2012 - take impedance difference from cases where Pearson signal goes into 'scope versus data going into digitizer, only.
#Make this ratio of impedance the current calibration.
#Calibration data - transfer function 
fspS=double([ 39848.197, 44205.496, 48703.352, 53130.930, 57558.507, 62056.364, 66483.941, 70911.519, 75128.259, 79485.558, 83913.135, 88340.713, 92698.011, 97055.310,101412.608,105769.907,110127.205,114484.503,118701.244,122917.984,127345.562,131632.581,135779.043,140066.062,144423.361,148710.380,152856.842,157073.582,161360.602,165507.063,169723.803,174010.823,178157.284,182374.025,186590.765,190666.948,194883.688,199030.150,203246.890,207252.794,211469.534,215545.716,219692.178,223979.197,227985.101,232131.562,236137.466,240354.206,244289.831,248366.013,252442.196,256518.378,260594.560,264600.464,268676.646,272752.829,276758.732,280764.636,284700.260,288776.442,292782.346,296788.249,300723.874,304870.335])

HspSr=-100.0000*double([0.98753,1.00429,1.00424,0.99855,0.99743,0.99170,0.98689,0.98413,0.98453,0.98223,0.97987,0.97914,0.97851,0.97740,0.97704,0.97609,0.97545,0.97436,0.97506,0.97524,0.97471,0.97461,0.97460,0.97362,0.97346,0.97334,0.97419,0.97406,0.97400,0.97497,0.97448,0.97476,0.97451,0.97462,0.97386,0.97408,0.97375,0.97360,0.97303,0.97335,0.97310,0.97345,0.97306,0.97242,0.97270,0.97255,0.97256,0.97234,0.97274,0.97236,0.97224,0.97224,0.97214,0.97249,0.97208,0.97181,0.97152,0.97108,0.97073,0.96993,0.96941,0.96851,0.96792,0.96859])

HspSi=-100.0000*double([-0.06527,-0.06884,-0.07354,-0.07860,-0.08348,-0.08877,-0.09395,-0.09877,-0.10323,-0.10817,-0.11298,-0.11768,-0.12219,-0.12682,-0.13148,-0.13617,-0.14083,-0.14546,-0.15006,-0.15457,-0.15925,-0.16392,-0.16863,-0.17338,-0.17811,-0.18294,-0.18758,-0.19237,-0.19722,-0.20202,-0.20685,-0.21185,-0.21684,-0.22185,-0.22687,-0.23187,-0.23702,-0.24214,-0.24746,-0.25260,-0.25789,-0.26315,-0.26846,-0.27390,-0.27912,-0.28472,-0.29031,-0.29587,-0.30132,-0.30673,-0.31240,-0.31795,-0.32379,-0.32973,-0.33538,-0.34128,-0.34724,-0.35307,-0.35911,-0.36489,-0.37027,-0.37478,-0.37901,-0.37919])

fsdS=double([ 38288.891, 41219.850, 42859.811, 44133.472, 44620.929, 45872.536, 46194.135, 46804.320, 47861.632, 48216.996, 48904.651, 49891.211, 50458.528, 50951.883, 51948.548, 52523.906, 53081.612, 54171.727, 54826.776, 55261.870, 56252.090, 56898.811, 57358.204, 58294.756, 59040.680, 59664.129, 60751.781, 61297.356, 61637.358, 62598.703, 63389.238, 63927.192, 64898.450, 65616.253, 65871.504, 66674.629, 67621.980, 68126.283, 68955.965, 69859.860, 70223.485, 70762.381, 71732.683, 72483.122, 72843.581, 73657.747, 74681.893, 75180.690, 75781.148, 76750.437, 77257.431, 77995.531, 79016.029, 79585.026, 79888.315, 80779.981, 81657.267, 82166.764, 83350.209, 84006.897, 84278.813, 85175.218, 86058.905, 86738.271, 87787.546, 88407.187, 88881.656, 89840.177, 90637.144, 91101.541, 91934.364, 92860.852, 93471.282, 94473.328, 95288.855, 95648.623, 96558.429, 97534.967, 98128.553, 99184.058, 99798.140,100149.310,101002.276,102022.844,102485.916,103128.056,104159.392,104825.985,105470.189,106441.385,106959.871,107545.361,108656.145,109312.199,109698.422,110704.288,111710.960,112213.425,113186.075,113853.649,114464.025,115425.308,116122.603,116488.039,117326.597,118383.684,118843.674,119270.049,120262.905,121112.485,121487.198,122121.406,123106.491,123755.128,124046.754,125194.899,126037.693,126822.875,127846.113,128320.186,129031.106,130023.618,130662.020,131050.850,131854.791,132949.537,133433.384,134249.980,135272.290,135863.337,136330.853,137402.714,138149.186,138646.534,139510.967,140291.644,140825.255,141380.894,142411.907,143033.445,143731.712,144778.961,145323.944,145652.562,146493.747,147488.522,147972.775,148492.209,149435.781,150178.434,150548.229,151186.052,152172.166,152804.430,153134.464,153955.293,154979.910,155497.363,155906.960,156838.755,157787.756,158232.100,159272.430,160237.078,160635.741,161203.204,162166.358,162857.228,163210.666,163900.390,165052.276,165690.702,166654.635,167798.932,168260.490,169059.527,170180.885,170696.346,171302.559,172259.754,172960.035,173319.512,173999.209,175077.768,175632.031,176252.576,177306.378,178011.443,178400.487,179299.140,180348.165,180805.752,181345.683,182556.243,183255.424,183675.683,184550.773,185454.171,185927.600,186441.407,187086.270,187990.597,188579.841,189119.636,189899.660,190736.786,191257.748,191880.796,192845.611,193623.265,194157.653,194778.406,195843.286,196473.222,196844.095,197826.228,198730.287,199166.952,199667.442,200791.375,201529.842,201919.884,202793.047,203712.314,204241.423,204730.288,205223.697,206127.804,207156.409,207641.193,208484.104,209433.816,209892.775,210827.791,211965.220,212502.923,213128.336,213943.182,214749.654,215326.796,215962.672,216804.134,217793.136,218224.137,219027.110,220125.251,220685.308,221945.989,223374.750,224403.151,225309.074,225782.157,226402.972,227191.838,228030.298,228757.125,229708.003,230974.377,231545.817,232265.618,233137.423,234066.139,234559.580,235115.937,236346.825,237247.339,238079.001,239098.974,239576.177,240223.412,241138.465,241976.673,242600.746,243080.827,243737.211,244627.149,245383.109,245897.368,246373.648,247414.365,248374.799,250192.437,251146.632,251946.183,253552.199,254264.153,255294.703,256190.341,256739.779,257269.023,257715.458,258670.598,259564.063,259975.283,260621.058,261395.017,262250.333,262876.574,263261.776,264060.387,265081.636,265588.752,266196.340,267179.810,268171.330,268696.918,269207.546,270335.406,271086.254,271782.420,272497.764,273385.627,273973.148,274429.212,275145.368,276156.299,276841.714,277422.191,277927.826,279018.190,279995.752,280665.202,281201.062,282205.851,282882.047,283455.899,284120.110,285148.827,286227.820,286718.760,287602.335,288439.118,288957.319,289490.761,290006.771,291229.944,291887.224,292417.419,292861.342,293704.682,294844.692,295291.391,296165.697,297238.689,297966.360,298481.373,299217.141,300265.354,301384.206,301892.353,302927.104,303773.301,304329.735])

HsdSr=-100.0000*double([0.97698,0.99099,0.99327,0.99153,0.99786,0.98695,0.99692,0.99570,0.99324,1.00167,1.00544,0.99934,1.00128,1.00023,0.99510,0.99407,0.99513,0.98931,0.99213,0.99828,0.99491,0.99589,0.99929,0.99133,0.99093,0.98757,0.98162,0.98683,0.99332,0.99169,0.98648,0.98839,0.98212,0.97900,0.98350,0.98263,0.97600,0.97933,0.97897,0.97898,0.98318,0.97999,0.97708,0.97369,0.97536,0.97579,0.97514,0.97975,0.98210,0.97455,0.97719,0.97472,0.96944,0.97117,0.97754,0.97964,0.97610,0.97781,0.97114,0.96976,0.97468,0.97304,0.97472,0.97804,0.97385,0.97388,0.97456,0.97315,0.97102,0.97269,0.97252,0.97436,0.97792,0.97378,0.97104,0.97594,0.97309,0.97044,0.97337,0.97437,0.97409,0.97785,0.97509,0.97089,0.97360,0.97389,0.97353,0.97613,0.97613,0.97258,0.97469,0.97560,0.97091,0.97352,0.97778,0.97652,0.97163,0.97430,0.97124,0.97125,0.97263,0.97327,0.97411,0.97627,0.97294,0.97134,0.97245,0.97462,0.97327,0.97221,0.97530,0.97427,0.97285,0.97223,0.97553,0.97346,0.97418,0.97328,0.97008,0.97257,0.96923,0.97003,0.97195,0.97524,0.97627,0.97157,0.97378,0.97193,0.97092,0.97310,0.97545,0.97249,0.97129,0.97170,0.97028,0.97105,0.97370,0.97484,0.97129,0.97233,0.97247,0.96957,0.97132,0.97460,0.97292,0.97023,0.97189,0.97275,0.97030,0.97039,0.97305,0.97486,0.97028,0.97197,0.97454,0.97314,0.97180,0.97382,0.97491,0.97295,0.97230,0.97110,0.97158,0.97182,0.97289,0.97336,0.97138,0.97145,0.97320,0.97521,0.97399,0.97430,0.97254,0.96962,0.97275,0.97358,0.96999,0.97210,0.97273,0.97068,0.97128,0.97381,0.97518,0.97116,0.97349,0.97318,0.97236,0.97278,0.97548,0.97432,0.97149,0.97310,0.97351,0.97292,0.97291,0.97273,0.97330,0.97083,0.97286,0.97432,0.97520,0.97330,0.97327,0.97348,0.97271,0.97322,0.97423,0.97560,0.97320,0.97201,0.97303,0.97380,0.97314,0.97334,0.97463,0.97281,0.97124,0.97376,0.97505,0.97250,0.97197,0.97296,0.97222,0.97259,0.97257,0.97365,0.97456,0.97357,0.97170,0.97262,0.97253,0.97188,0.97275,0.97182,0.97100,0.97235,0.97173,0.97275,0.97171,0.97287,0.97412,0.97348,0.97240,0.97299,0.97406,0.97377,0.97464,0.97272,0.97021,0.97008,0.96908,0.97069,0.97136,0.97215,0.97376,0.97309,0.97270,0.97065,0.97249,0.97343,0.97307,0.97119,0.97298,0.97400,0.97251,0.97179,0.97140,0.97093,0.97202,0.97252,0.97064,0.96993,0.97064,0.97255,0.97174,0.97099,0.97000,0.97220,0.97400,0.97343,0.97258,0.97084,0.97134,0.97151,0.96922,0.97108,0.97019,0.96903,0.97058,0.97199,0.97336,0.97163,0.97108,0.97224,0.97187,0.97262,0.97195,0.97154,0.97193,0.97214,0.97206,0.97215,0.97277,0.97088,0.97098,0.97209,0.97306,0.97153,0.97141,0.97158,0.97208,0.97094,0.97118,0.97159,0.97256,0.97103,0.97049,0.97070,0.97223,0.97137,0.96988,0.97027,0.97124,0.97072,0.97122,0.97131,0.97162,0.97016,0.96930,0.97029,0.96890,0.96849,0.96947,0.96955,0.97032,0.96799,0.96816,0.96933,0.97095,0.96958,0.96792,0.96866,0.96939,0.96740,0.96767,0.96843,0.96949,0.96767,0.96581,0.96739,0.96668,0.96644,0.96702])

HsdSi=-100.0000*double([-0.06962,-0.07069,-0.06949,-0.07071,-0.06956,-0.07191,-0.07106,-0.07191,-0.07315,-0.07309,-0.07296,-0.07444,-0.07501,-0.07628,-0.07769,-0.07868,-0.07919,-0.08074,-0.08140,-0.08103,-0.08206,-0.08296,-0.08342,-0.08511,-0.08549,-0.08666,-0.08799,-0.08816,-0.08772,-0.08850,-0.08942,-0.08992,-0.09127,-0.09214,-0.09240,-0.09315,-0.09433,-0.09456,-0.09574,-0.09670,-0.09724,-0.09831,-0.09956,-0.10065,-0.10117,-0.10180,-0.10282,-0.10340,-0.10378,-0.10538,-0.10585,-0.10674,-0.10785,-0.10836,-0.10831,-0.10894,-0.10995,-0.11042,-0.11155,-0.11212,-0.11256,-0.11360,-0.11410,-0.11463,-0.11585,-0.11655,-0.11744,-0.11839,-0.11962,-0.12039,-0.12099,-0.12152,-0.12228,-0.12339,-0.12457,-0.12506,-0.12581,-0.12684,-0.12729,-0.12808,-0.12926,-0.13002,-0.13086,-0.13176,-0.13239,-0.13331,-0.13411,-0.13482,-0.13577,-0.13674,-0.13726,-0.13763,-0.13867,-0.13948,-0.13997,-0.14093,-0.14192,-0.14244,-0.14320,-0.14416,-0.14482,-0.14586,-0.14671,-0.14725,-0.14825,-0.14904,-0.14983,-0.15060,-0.15139,-0.15209,-0.15268,-0.15358,-0.15440,-0.15525,-0.15581,-0.15666,-0.15755,-0.15835,-0.15938,-0.16011,-0.16108,-0.16175,-0.16240,-0.16310,-0.16401,-0.16510,-0.16576,-0.16672,-0.16751,-0.16818,-0.16886,-0.16988,-0.17082,-0.17155,-0.17248,-0.17316,-0.17393,-0.17478,-0.17592,-0.17669,-0.17746,-0.17843,-0.17909,-0.17973,-0.18050,-0.18142,-0.18195,-0.18245,-0.18322,-0.18403,-0.18463,-0.18527,-0.18626,-0.18684,-0.18755,-0.18835,-0.18918,-0.18995,-0.19078,-0.19165,-0.19226,-0.19325,-0.19381,-0.19478,-0.19550,-0.19637,-0.19731,-0.19851,-0.19966,-0.20030,-0.20134,-0.20237,-0.20335,-0.20447,-0.20522,-0.20611,-0.20716,-0.20755,-0.20808,-0.20919,-0.21013,-0.21091,-0.21187,-0.21299,-0.21358,-0.21435,-0.21527,-0.21611,-0.21692,-0.21796,-0.21887,-0.21956,-0.22039,-0.22136,-0.22237,-0.22330,-0.22389,-0.22484,-0.22533,-0.22588,-0.22652,-0.22757,-0.22851,-0.22951,-0.23053,-0.23151,-0.23244,-0.23327,-0.23426,-0.23522,-0.23609,-0.23685,-0.23785,-0.23857,-0.23949,-0.24038,-0.24118,-0.24177,-0.24262,-0.24377,-0.24468,-0.24564,-0.24669,-0.24757,-0.24819,-0.24903,-0.24994,-0.25104,-0.25219,-0.25307,-0.25426,-0.25530,-0.25610,-0.25711,-0.25800,-0.25888,-0.25993,-0.26085,-0.26207,-0.26302,-0.26377,-0.26475,-0.26572,-0.26679,-0.26786,-0.26892,-0.27000,-0.27130,-0.27276,-0.27380,-0.27497,-0.27589,-0.27697,-0.27790,-0.27887,-0.28008,-0.28128,-0.28263,-0.28357,-0.28475,-0.28587,-0.28703,-0.28793,-0.28885,-0.29031,-0.29168,-0.29292,-0.29415,-0.29515,-0.29596,-0.29689,-0.29769,-0.29853,-0.29930,-0.30015,-0.30131,-0.30239,-0.30349,-0.30440,-0.30579,-0.30684,-0.30837,-0.30987,-0.31105,-0.31262,-0.31398,-0.31566,-0.31727,-0.31869,-0.31978,-0.32058,-0.32154,-0.32238,-0.32312,-0.32396,-0.32499,-0.32575,-0.32670,-0.32740,-0.32853,-0.32967,-0.33099,-0.33218,-0.33372,-0.33490,-0.33569,-0.33656,-0.33741,-0.33844,-0.33950,-0.34047,-0.34149,-0.34244,-0.34340,-0.34434,-0.34566,-0.34708,-0.34856,-0.34976,-0.35118,-0.35255,-0.35353,-0.35462,-0.35564,-0.35667,-0.35776,-0.35877,-0.35966,-0.36055,-0.36128,-0.36229,-0.36342,-0.36436,-0.36553,-0.36670,-0.36823,-0.36922,-0.37020,-0.37133,-0.37242,-0.37335,-0.37440,-0.37549,-0.37634,-0.37736,-0.37822,-0.37920,-0.37942,-0.37924,-0.37990,-0.37975,-0.37965,-0.38049])

#Combine real and imaginary parts of transfer function
HspS=HspSr+1j*HspSi #Synchronous detection
HsdS=HsdSr+1j*HsdSi #Spectrogram method
#Save data to numpy binary array
save("fsdSBox2i", fsdS)
save("HsdSBox2i", HsdS)
save("fspSBox2i", fspS)
save("HspSBox2i", HspS)

