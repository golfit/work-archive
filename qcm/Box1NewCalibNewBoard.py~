#Board #1 in Box #1 blew up (one of the 220 pF caps smoked and left a crater in the board).  Needed a new calibration (below).
#This calibration was "in-place", with board being digitized on scope in parallel with digitizer.
#Ted Golfinopoulos, 12 June 2012

from numpy import *

#Spectrogram method
#Frequency points [Hz]
fspS=[39848.197, 44205.496, 48773.631, 53130.930, 57628.786, 62056.364, 66483.941, 70911.519, 75198.538, 79555.837, 83913.135, 88340.713, 92698.011, 97055.310,101412.608,105840.186,110127.205,114484.503,118701.244,122917.984,127345.562,131632.581,135779.043,140136.341,144423.361,148710.380,152856.842,157073.582,161360.602,165507.063,169723.803,174010.823,178157.284,182374.025,186590.765,190737.227,194953.967,199100.429,203246.890,207252.794,211469.534,215615.995,219692.178,223979.197,227914.822,232201.841,236137.466,240354.206,244360.110,248366.013,252442.196,256588.657,260664.839,264600.464,268676.646,272682.550,276758.732,280764.636,284700.260,288776.442,292782.346,296717.970,300653.595,304870.335]

#Transfer function, V_scope_probe/V_voltage_div
#Real part
HspSr=[191.26254, 198.01742, 201.17052, 203.18420, 204.71376, 205.98569, 207.61547, 208.68802, 209.57683, 210.30838, 210.93110, 211.47041, 211.93264, 212.32351, 212.68729, 212.98587, 213.24067, 213.44697, 213.63552, 213.80984, 213.96282, 214.10045, 214.21865, 214.33202, 214.41524, 214.50015, 214.58833, 214.69523, 214.76679, 214.83040, 214.89192, 214.94749, 214.99882, 215.03426, 215.09245, 215.14477, 215.19129, 215.20974, 215.24076, 215.28380, 215.32555, 215.35654, 215.35454, 215.37624, 215.40131, 215.43496, 215.46607, 215.48598, 215.54929, 215.56604, 215.57691, 215.60282, 215.64791, 215.65759, 215.68756, 215.67506, 215.66687, 215.72782, 215.79551, 215.85055, 215.91030, 215.99862, 216.38318, 216.78124]

#Imaginary part
HspSi=[-4.63175,  -0.08654,   0.50919,   0.85536,   1.04255,   1.20460,   1.42934,   1.48848,   1.53804,   1.54055,   1.50699,   1.45542,   1.39556,   1.33844,   1.24601,   1.13232,   1.02199,   0.91487,   0.78762,   0.65762,   0.52755,   0.38310,   0.24262,   0.10652,  -0.01348,  -0.13699,  -0.26757,  -0.40378,  -0.52324,  -0.65134,  -0.76128,  -0.86670,  -0.98808,  -1.11034,  -1.20955,  -1.31116,  -1.40821,  -1.49787,  -1.58650,  -1.65523,  -1.73567,  -1.83708,  -1.94412,  -2.02988,  -2.09223,  -2.13279,  -2.21099,  -2.28356,  -2.30856,  -2.39815,  -2.45199,  -2.47496,  -2.51340,  -2.55553,  -2.58020,  -2.66953,  -2.67027,  -2.70819,  -2.80570,  -2.83342,  -2.84863,  -2.94976,  -3.05185,  -3.73391]

#Synchronous detection method
#Frequency points [Hz]
fsdS=[41889.73810,44114.57039,47848.93812,52576.46410,55630.48484,58185.95508,61647.89654,65086.55562,68758.19769,71854.76215,73788.48172,76403.06734,78968.42664,80720.61094,82550.04296,84456.04357,86301.06141,88075.81920,89906.79700,92543.52583,93853.35854,95387.11950,96832.77403,98878.78108,100226.63678,102008.50218,103285.18041,104611.46328,106293.18119,107857.89442,109560.34787,111524.48155,112806.30551,114115.44864,115722.77062,116743.02336,118426.11533,119554.64387,121166.87538,122445.24462,123850.19694,125370.84030,126554.69702,128129.17313,129331.58832,130886.41118,132332.29957,133671.36082,135343.03903,136353.42075,137962.71974,139478.48858,140607.37864,141951.44914,143239.40949,144849.99466,145864.05986,147523.93011,148519.18696,150167.16031,151207.41134,152785.08675,153905.70187,155389.27588,156635.32446,157983.32515,159338.73835,160594.89927,162044.90213,163209.85761,164730.23503,165854.74141,167414.51420,168471.84837,170094.20024,171121.67727,172767.10690,173762.37030,175424.37537,176444.83816,178048.29137,179346.71238,180733.12052,182063.50219,183366.07825,184925.72418,186082.94198,187372.12506,188723.76542,190450.61857,191410.03891,192906.03763,194063.58325,195676.80808,196747.68932,198268.84665,199510.00387,201033.14222,202016.42480,203623.69902,204645.08953,205890.00058,207269.38759,208615.85831,209879.89494,211310.13576,212483.10033,214004.51966,215353.57963,216539.09684,217985.63870,219287.61457,220582.77522,222140.55578,223406.64113,224984.75222,226059.38570,227196.52046,228710.19944,229937.76715,231285.77171,232656.30861,233928.78790,234999.81665,236704.32710,237711.37390,239342.39113,240301.91430,241859.54354,242990.45559,244540.31688,245631.91714,246748.06557,248294.94705,249500.34686,250871.93779,251873.82073,253426.66046,254649.47742,256117.61620,257130.02311,258381.56639,259731.31614,261108.56104,262373.94921,263382.18144,264995.69191,266069.77761,267631.85195,268689.51661,270162.44340,271366.20556,272385.42656,274037.76940,275040.20709,276652.34758,277567.45101,279038.23214,280236.04348,281275.67874,282901.01576,283804.38892,285375.89601,286542.91787,288073.72344,289206.56275,290301.33009,291858.28657,292775.29523,294281.02317,295471.24771,296492.75323,298106.86382,299027.04053,300489.57655,301639.96119,303175.37302,304360.18923]

#Transfer function
#Real part
HsdSr=[196.53879, 199.18392, 201.69070, 203.30593, 204.49780, 205.56614, 206.79198, 207.76644, 208.48037, 209.05719, 209.58141, 209.98065, 210.37372, 210.69497, 210.96303, 211.17010, 211.36943, 211.57581, 211.74636, 211.90828, 212.02617, 212.19678, 212.29345, 212.41293, 212.51852, 212.62396, 212.74413, 212.84941, 212.93356, 213.02276, 213.12527, 213.20208, 213.28531, 213.35673, 213.41726, 213.48860, 213.52185, 213.53816, 213.59489, 213.65151, 213.66502, 213.70376, 213.75223, 213.75419, 213.79083, 213.81598, 213.85917, 213.88998, 213.92682, 213.95177, 213.99126, 214.02439, 214.06718, 214.10340, 214.12026, 214.15676, 214.19512, 214.23830, 214.27774, 214.32013, 214.35855, 214.41710, 214.44822, 214.49276, 214.53605, 214.55868, 214.56727, 214.58274, 214.60403, 214.59460, 214.59993, 214.59808, 214.64450, 214.66942, 214.67845, 214.70811, 214.75616, 214.75387, 214.77383, 214.82000, 214.83769, 214.82679, 214.82142, 214.84407, 214.84184, 214.83960, 214.83894, 214.87904, 214.88703, 214.89154, 214.91759, 214.96515, 214.97141, 214.96656, 214.96964, 214.98767, 215.03386, 215.04875, 215.05032, 215.06714, 215.07055, 215.08905, 215.11242, 215.12185, 215.14278, 215.13192, 215.11159, 215.12790, 215.15306, 215.14695, 215.13593, 215.12177, 215.13150, 215.18748, 215.21079, 215.21898, 215.23220, 215.23135, 215.23134, 215.25027, 215.27058, 215.23429, 215.16008, 215.09985, 215.10651, 215.12712, 215.12001, 215.13032, 215.14900, 215.15953, 215.17604, 215.23820, 215.33278, 215.41224, 215.41457, 215.38893, 215.37476, 215.34615, 215.35344, 215.40473, 215.42633, 215.45953, 215.47049, 215.42835, 215.41936, 215.43613, 215.46239, 215.49919, 215.46130, 215.40229, 215.40711, 215.41434, 215.35729, 215.32345, 215.31019, 215.29766, 215.28346, 215.29718, 215.37320, 215.40992, 215.38577, 215.33203, 215.32245, 215.33644, 215.34385, 215.35470, 215.36927, 215.36584, 215.35894, 215.41253, 215.48404, 215.57993, 215.72364, 215.87762, 216.06126, 216.23037, 216.33011, 216.46698]

#Imaginary part
HsdSi=[0.48013,   0.46394,   0.58643,   0.73235,   0.85420,   0.93000,   1.00974,   1.06786,   1.12598,   1.16796,   1.17123,   1.15566,   1.13802,   1.11648,   1.08284,   1.06132,   1.02723,   0.99291,   0.96994,   0.91811,   0.88520,   0.87737,   0.84966,   0.83064,   0.80485,   0.82189,   0.84591,   0.82743,   0.82732,   0.82238,   0.81516,   0.78624,   0.77289,   0.73104,   0.68105,   0.59878,   0.52077,   0.46157,   0.39075,   0.34165,   0.28864,   0.26452,   0.21109,   0.17632,   0.14037,   0.10965,   0.07346,   0.04278,  -0.00405,  -0.04434,  -0.08394,  -0.14825,  -0.22899,  -0.27810,  -0.32535,  -0.38267,  -0.42758,  -0.43847,  -0.45359,  -0.46124,  -0.44979,  -0.45249,  -0.44087,  -0.43950,  -0.43017,  -0.43963,  -0.44843,  -0.45299,  -0.50014,  -0.55429,  -0.62223,  -0.64534,  -0.66791,  -0.73258,  -0.77347,  -0.77142,  -0.82837,  -0.89300,  -0.88231,  -0.91004,  -0.98172,  -1.03538,  -1.05977,  -1.06772,  -1.13246,  -1.18273,  -1.19142,  -1.23486,  -1.31190,  -1.36214,  -1.36834,  -1.39656,  -1.42519,  -1.49098,  -1.50352,  -1.52363,  -1.54733,  -1.56802,  -1.59199,  -1.59652,  -1.63162,  -1.66058,  -1.66215,  -1.68052,  -1.72759,  -1.76353,  -1.77798,  -1.81904,  -1.80727,  -1.83267,  -1.84658,  -1.88831,  -1.91316,  -1.89597,  -1.89608,  -1.94648,  -1.98621,  -2.01880,  -2.07623,  -2.13167,  -2.16980,  -2.21415,  -2.32681,  -2.38085,  -2.42770,  -2.43285,  -2.41746,  -2.41513,  -2.40255,  -2.35804,  -2.33492,  -2.28133,  -2.19421,  -2.18898,  -2.22425,  -2.28833,  -2.35392,  -2.35043,  -2.34957,  -2.33023,  -2.34171,  -2.36791,  -2.42275,  -2.50625,  -2.50818,  -2.49049,  -2.47563,  -2.50965,  -2.55136,  -2.59632,  -2.63905,  -2.68625,  -2.73199,  -2.71832,  -2.72033,  -2.74107,  -2.77608,  -2.78321,  -2.75247,  -2.74547,  -2.73488,  -2.79893,  -2.82934,  -2.79028,  -2.77209,  -2.74381,  -2.73419,  -2.74010,  -2.81687,  -2.87704,  -2.92426,  -2.87660,  -2.87745,  -2.92901,  -3.01253,  -3.11826,  -3.16780,  -3.46678]

#Complex transfer function - multiply the Fourier transform of the output voltage of the capacitive voltage divider by this and then inverse Fourier transform to construct the correct output voltage.
HsdS=double(HsdSr) + 1j*double(HsdSi)
HsdS=double(HsdSr) + 1j*double(HsdSi)

#Save data to numpy format.
save('fsdSBox1', fsdS)
save('HsdSBox1', HsdS)
save('fspSBox1', fspS)
save('HspSBox1', HspS)
